# Квиз для подбора практик: Детальное описание флоу

## Общая схема работы квиза

1. **Стартовый экран**
   - Пользователь видит заголовок "Подбор практики"
   - Краткое описание процесса квиза
   - Кнопка "Начать" для запуска процесса

2. **Шаг 1: Выбор типа практики**
   - Пользователь выбирает один из типов практик:
     - Медитативная практика
     - Телесная практика
     - Дыхательная практика
   - Каждый тип представлен карточкой с иконкой и описанием
   - Кнопка "Далее" для перехода к следующему шагу

3. **Шаг 2: Выбор длительности практики**
   - Пользователь выбирает предпочитаемую длительность:
     - 5 минут
     - 10 минут
     - 15 минут
     - 20 минут
     - 30 минут
   - Представлено в виде слайдера или кнопок выбора
   - Кнопки "Назад" и "Далее" для навигации

4. **Шаг 3: Выбор цели практики**
   - Пользователь выбирает цель (зависит от выбранного типа практики):
     - Для медитативных: снятие стресса, улучшение концентрации, расслабление
     - Для телесных: растяжка, укрепление, энергия
     - Для дыхательных: спокойствие, энергия, выносливость
   - Представлено карточками с кратким описанием
   - Кнопки "Назад" и "Далее" для навигации

5. **Шаг 4: Выбор подхода к практике**
   - Пользователь выбирает предпочитаемый подход:
     - С инструктором (guided)
     - Самостоятельная практика (self-practice)
   - Представлено двумя карточками с описанием
   - Кнопки "Назад" и "Подобрать практику" для завершения квиза

6. **Экран результата**
   - Показ подобранной практики на основе выбранных параметров
   - Отображение названия, описания и длительности практики
   - Кнопка "Начать практику" для перехода к плееру
   - Кнопка "Выбрать другую практику" для повторного запуска квиза

7. **Экран плеера**
   - В зависимости от типа контента отображается соответствующий режим плеера:
     - Медитационный режим (таймер с визуализацией)
     - Видео режим (видео-плеер с инструкциями)
   - Элементы управления: пауза, перемотка, изменение громкости
   - Кнопка "Завершить" для возврата на главный экран

## Логика работы с Supabase

1. **Запрос данных**
   - При инициализации квиза загружаются все доступные опции из таблицы quizlogic
   - На каждом шаге квиза фильтруются доступные опции для следующего шага
   - После последнего шага выполняется запрос для получения подходящей практики

2. **Фильтрация результатов**
   - Последовательная фильтрация происходит по выбранным параметрам:
     1. Тип практики (`type`)
     2. Длительность (`duration`)
     3. Цель (`goal`)
     4. Подход (`approach`)
   - Если подходящих практик несколько, выбирается случайная из них
   - Если нет точного совпадения, находится ближайшая по параметрам практика

3. **Загрузка контента**
   - После выбора практики загружается соответствующий контент:
     - Для медитации - аудио фон и таймер
     - Для видео - видеофайл с инструкциями

## Хранение состояния

1. **Состояние квиза**
   - Все выбранные пользователем параметры хранятся в React контексте (QuizContext)
   - При навигации "Назад" восстанавливаются ранее выбранные значения
   - Состояние сохраняется при перезагрузке страницы через localStorage

2. **Состояние плеера**
   - Текущий прогресс воспроизведения и настройки хранятся в PlayerContext
   - При переключении между режимами сохраняется общее состояние (громкость и т.д.)

## Описание режимов плеера

1. **Медитационный режим**
   - Визуализация времени в виде круговой анимации
   - Фоновое аудио с возможностью регулировки громкости
   - Опциональные текстовые подсказки в ходе практики
   - Уведомление о завершении практики

2. **Видео режим**
   - Воспроизведение видео с инструкциями по практике
   - Стандартные элементы управления видео
   - Возможность полноэкранного просмотра
   - Отображение текстовой информации рядом с видео

## Зависимости между выборами

- Выбор типа практики определяет доступные опции цели
- Выбор подхода к практике влияет на тип контента (видео для guided, таймер для self-practice)
- Длительность практики влияет на доступные практики для выбора 